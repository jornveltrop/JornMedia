import type { NextPage } from 'next'
import Head from 'next/head'
import {gql, GraphQLClient } from 'graphql-request';

interface HomeProps {
  home: {title: String}
}

const Home: NextPage<HomeProps>  = ( {home} ) => {

  // console.log(home)
  return (
    <>
      <Head>
        <title>JornMedia</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <h1>{home.title}</h1>
    </>
  )
}

const query = gql`
  query {
    home {
      siteLogo {
        alt
        url
        width
        height
      }
      backgroundPhoto {
        url
        width
        height
      }
      title
      tagline
      skillsSummary {
        skillText
      }
      description
      section {
        ... on GridSectionRecord {
          title
          items {
            title
          }
        }
        ... on CardsSectionRecord {
          title
          cards {
            cardTitle
            cardDescription(markdown: false)
          }
        }
        ... on TextSectionRecord {
          title
          description
        }
      }
    }
  }
`

export async function getStaticProps () {
  const endpoint = "https://graphql.datocms.com/";
  const graphQLClient = new  GraphQLClient(endpoint, {
    headers: {
      "content-type": "application/json",
      authorization: "Bearer " + process.env.DATOCMS_API_KEY,
    }
  })
  const data = await graphQLClient.request(query)
  console.log(data)
  return {
    props: data
  }
}

export default Home
